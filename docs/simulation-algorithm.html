<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>2 Simulation algorithm | DAISIEmainland: Simulating and analysing macroevolution on island with a dynamic mainland</title>
  <meta name="description" content="This is an introduction to the DAISIEmainland package." />
  <meta name="generator" content="bookdown 0.26 and GitBook 2.6.7" />

  <meta property="og:title" content="2 Simulation algorithm | DAISIEmainland: Simulating and analysing macroevolution on island with a dynamic mainland" />
  <meta property="og:type" content="book" />
  
  <meta property="og:description" content="This is an introduction to the DAISIEmainland package." />
  

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="2 Simulation algorithm | DAISIEmainland: Simulating and analysing macroevolution on island with a dynamic mainland" />
  
  <meta name="twitter:description" content="This is an introduction to the DAISIEmainland package." />
  

<meta name="author" content="Joshua W. Lambert" />


<meta name="date" content="2022-04-28" />

  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="installation.html"/>
<link rel="next" href="simulation-data-visualisation.html"/>
<script src="libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/fuse.js@6.4.6/dist/fuse.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />








<link href="libs/anchor-sections-1.1.0/anchor-sections.css" rel="stylesheet" />
<link href="libs/anchor-sections-1.1.0/anchor-sections-hash.css" rel="stylesheet" />
<script src="libs/anchor-sections-1.1.0/anchor-sections.js"></script>


<style type="text/css">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

<style type="text/css">
/* Used with Pandoc 2.11+ new --citeproc when CSL is used */
div.csl-bib-body { }
div.csl-entry {
  clear: both;
}
.hanging div.csl-entry {
  margin-left:2em;
  text-indent:-2em;
}
div.csl-left-margin {
  min-width:2em;
  float:left;
}
div.csl-right-inline {
  margin-left:2em;
  padding-left:1em;
}
div.csl-indent {
  margin-left: 2em;
}
</style>

</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li class="chapter" data-level="" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i>DAISIEmainland guide</a>
<ul>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#overview"><i class="fa fa-check"></i>Overview</a></li>
</ul></li>
<li class="chapter" data-level="1" data-path="installation.html"><a href="installation.html"><i class="fa fa-check"></i><b>1</b> Installation</a></li>
<li class="chapter" data-level="2" data-path="simulation-algorithm.html"><a href="simulation-algorithm.html"><i class="fa fa-check"></i><b>2</b> Simulation algorithm</a>
<ul>
<li class="chapter" data-level="2.1" data-path="simulation-algorithm.html"><a href="simulation-algorithm.html#mainland-simulation"><i class="fa fa-check"></i><b>2.1</b> Mainland simulation</a></li>
<li class="chapter" data-level="2.2" data-path="simulation-algorithm.html"><a href="simulation-algorithm.html#island-simulation"><i class="fa fa-check"></i><b>2.2</b> Island simulation</a></li>
</ul></li>
<li class="chapter" data-level="3" data-path="simulation-data-visualisation.html"><a href="simulation-data-visualisation.html"><i class="fa fa-check"></i><b>3</b> Simulation data visualisation</a>
<ul>
<li class="chapter" data-level="3.1" data-path="simulation-data-visualisation.html"><a href="simulation-data-visualisation.html#visualise-mainland"><i class="fa fa-check"></i><b>3.1</b> Visualise mainland</a></li>
<li class="chapter" data-level="3.2" data-path="simulation-data-visualisation.html"><a href="simulation-data-visualisation.html#visualise-island"><i class="fa fa-check"></i><b>3.2</b> Visualise island</a></li>
</ul></li>
<li class="chapter" data-level="4" data-path="inference-performance.html"><a href="inference-performance.html"><i class="fa fa-check"></i><b>4</b> Inference performance</a>
<ul>
<li class="chapter" data-level="4.1" data-path="inference-performance.html"><a href="inference-performance.html#simulating-data"><i class="fa fa-check"></i><b>4.1</b> Simulating data</a></li>
<li class="chapter" data-level="4.2" data-path="inference-performance.html"><a href="inference-performance.html#maximum-likelihood-inference"><i class="fa fa-check"></i><b>4.2</b> Maximum likelihood inference</a></li>
<li class="chapter" data-level="4.3" data-path="inference-performance.html"><a href="inference-performance.html#inference-performance-error-metrics"><i class="fa fa-check"></i><b>4.3</b> Inference performance error metrics</a></li>
</ul></li>
<li class="chapter" data-level="5" data-path="summary-error-metrics-visualisation.html"><a href="summary-error-metrics-visualisation.html"><i class="fa fa-check"></i><b>5</b> Summary and error metrics visualisation</a>
<ul>
<li class="chapter" data-level="5.1" data-path="summary-error-metrics-visualisation.html"><a href="summary-error-metrics-visualisation.html#simulation-summary-metrics"><i class="fa fa-check"></i><b>5.1</b> Simulation summary metrics</a></li>
<li class="chapter" data-level="5.2" data-path="summary-error-metrics-visualisation.html"><a href="summary-error-metrics-visualisation.html#inference-error-metrics"><i class="fa fa-check"></i><b>5.2</b> Inference error metrics</a></li>
</ul></li>
<li class="chapter" data-level="6" data-path="references.html"><a href="references.html"><i class="fa fa-check"></i><b>6</b> References</a></li>
<li class="appendix"><span><b>Appendix</b></span></li>
<li class="chapter" data-level="A" data-path="daisiemainland-data-standards.html"><a href="daisiemainland-data-standards.html"><i class="fa fa-check"></i><b>A</b> DAISIEmainland data standards</a>
<ul>
<li class="chapter" data-level="A.1" data-path="daisiemainland-data-standards.html"><a href="daisiemainland-data-standards.html#reasoning"><i class="fa fa-check"></i><b>A.1</b> Reasoning</a></li>
<li class="chapter" data-level="A.2" data-path="daisiemainland-data-standards.html"><a href="daisiemainland-data-standards.html#data-structure-types"><i class="fa fa-check"></i><b>A.2</b> Data structure types</a>
<ul>
<li class="chapter" data-level="A.2.1" data-path="daisiemainland-data-standards.html"><a href="daisiemainland-data-standards.html#daisie-mainland-data"><i class="fa fa-check"></i><b>A.2.1</b> <code>daisie_mainland_data</code></a></li>
<li class="chapter" data-level="A.2.2" data-path="daisiemainland-data-standards.html"><a href="daisiemainland-data-standards.html#multi-daisie-data"><i class="fa fa-check"></i><b>A.2.2</b> <code>multi_daisie_data</code></a></li>
<li class="chapter" data-level="A.2.3" data-path="daisiemainland-data-standards.html"><a href="daisiemainland-data-standards.html#daisie-data"><i class="fa fa-check"></i><b>A.2.3</b> <code>daisie_data</code></a></li>
<li class="chapter" data-level="A.2.4" data-path="daisiemainland-data-standards.html"><a href="daisiemainland-data-standards.html#multi-mainland-clade"><i class="fa fa-check"></i><b>A.2.4</b> <code>multi_mainland_clade</code></a></li>
<li class="chapter" data-level="A.2.5" data-path="daisiemainland-data-standards.html"><a href="daisiemainland-data-standards.html#mainland-clade"><i class="fa fa-check"></i><b>A.2.5</b> <code>mainland_clade</code></a></li>
<li class="chapter" data-level="A.2.6" data-path="daisiemainland-data-standards.html"><a href="daisiemainland-data-standards.html#island-tbl"><i class="fa fa-check"></i><b>A.2.6</b> <code>island_tbl</code></a></li>
</ul></li>
</ul></li>
</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">DAISIEmainland: Simulating and analysing macroevolution on island with a dynamic mainland</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="simulation-algorithm" class="section level1 hasAnchor" number="2">
<h1><span class="header-section-number">2</span> Simulation algorithm<a href="simulation-algorithm.html#simulation-algorithm" class="anchor-section" aria-label="Anchor link to header"></a></h1>
<p>The Doob-Gillespie algorithm is a stochastic exact solution that is used to
simulate continuous-time processes, with several applications
in biological modelling. The Doob-Gillespie algorithm
can be used in evolutionary biology, for example to efficiently simulate a
birth-death process. The island-mainland simulation in the DAISIEmainland
package uses a two-part Doob-Gillespie simulation, one for the mainland
(<code>DAISIEmainland::sim_mainland</code>) and one for the island
(<code>DAISIEmainland::sim_island</code>).</p>
<div id="mainland-simulation" class="section level2 hasAnchor" number="2.1">
<h2><span class="header-section-number">2.1</span> Mainland simulation<a href="simulation-algorithm.html#mainland-simulation" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>The simulation of the island phylogenetic data takes two simulations. Firstly
the mainland, which is simulated under a Moran process, whereby every species extinction is immediately followed by a random species giving rise to two new species (speciation). Then the mainland phylogenetic data is fed into the
island simulation (Section <a href="simulation-algorithm.html#island-simulation">2.2</a>).</p>
<p>The mainland simulation uses a Doob-Gillespie algorithm to simulate the
speciation and extinction of species under a Moran process to maintain a
constant number of species. Here the example shows mainland data being
simulated for a time duration of one (million years), five initial mainland species, and a mainland extinction rate of one (per species per million years).</p>
<div class="sourceCode" id="cb4"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb4-1"><a href="simulation-algorithm.html#cb4-1" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(</span>
<span id="cb4-2"><a href="simulation-algorithm.html#cb4-2" aria-hidden="true" tabindex="-1"></a>  <span class="dv">1</span>,</span>
<span id="cb4-3"><a href="simulation-algorithm.html#cb4-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">kind =</span> <span class="st">&quot;Mersenne-Twister&quot;</span>,</span>
<span id="cb4-4"><a href="simulation-algorithm.html#cb4-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">normal.kind =</span> <span class="st">&quot;Inversion&quot;</span>,</span>
<span id="cb4-5"><a href="simulation-algorithm.html#cb4-5" aria-hidden="true" tabindex="-1"></a>  <span class="at">sample.kind =</span> <span class="st">&quot;Rejection&quot;</span></span>
<span id="cb4-6"><a href="simulation-algorithm.html#cb4-6" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb4-7"><a href="simulation-algorithm.html#cb4-7" aria-hidden="true" tabindex="-1"></a>mainland <span class="ot">&lt;-</span> DAISIEmainland<span class="sc">:::</span><span class="fu">sim_mainland</span>(</span>
<span id="cb4-8"><a href="simulation-algorithm.html#cb4-8" aria-hidden="true" tabindex="-1"></a>  <span class="at">total_time =</span> <span class="dv">1</span>,</span>
<span id="cb4-9"><a href="simulation-algorithm.html#cb4-9" aria-hidden="true" tabindex="-1"></a>  <span class="at">m =</span> <span class="dv">5</span>,</span>
<span id="cb4-10"><a href="simulation-algorithm.html#cb4-10" aria-hidden="true" tabindex="-1"></a>  <span class="at">mainland_ex =</span> <span class="dv">1</span></span>
<span id="cb4-11"><a href="simulation-algorithm.html#cb4-11" aria-hidden="true" tabindex="-1"></a>)</span></code></pre></div>
<p>The output is a list of five mainland clades called <code>multi_mainland_clade</code> (
see Section <a href="daisiemainland-data-standards.html#multi-mainland-clade">A.2.4</a>).</p>
<div class="sourceCode" id="cb5"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb5-1"><a href="simulation-algorithm.html#cb5-1" aria-hidden="true" tabindex="-1"></a>mainland</span>
<span id="cb5-2"><a href="simulation-algorithm.html#cb5-2" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; [[1]]</span></span>
<span id="cb5-3"><a href="simulation-algorithm.html#cb5-3" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;   spec_id main_anc_id spec_type branch_code  branch_t spec_origin_t spec_ex_t</span></span>
<span id="cb5-4"><a href="simulation-algorithm.html#cb5-4" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 1       1           1         E           A       NaN     0.0000000 0.7579891</span></span>
<span id="cb5-5"><a href="simulation-algorithm.html#cb5-5" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 2      10           1         E          AA 0.7579891     0.7579891 0.9493026</span></span>
<span id="cb5-6"><a href="simulation-algorithm.html#cb5-6" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 3      11           1         C          AB 0.7579891     0.7579891 1.0000000</span></span>
<span id="cb5-7"><a href="simulation-algorithm.html#cb5-7" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 4      12           1         C         AAA 0.9493026     0.9493026 1.0000000</span></span>
<span id="cb5-8"><a href="simulation-algorithm.html#cb5-8" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 5      13           1         C         AAB 0.9493026     0.9493026 1.0000000</span></span>
<span id="cb5-9"><a href="simulation-algorithm.html#cb5-9" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb5-10"><a href="simulation-algorithm.html#cb5-10" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; [[2]]</span></span>
<span id="cb5-11"><a href="simulation-algorithm.html#cb5-11" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;   spec_id main_anc_id spec_type branch_code  branch_t spec_origin_t spec_ex_t</span></span>
<span id="cb5-12"><a href="simulation-algorithm.html#cb5-12" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 1       2           2         E           A       NaN     0.0000000 0.1789954</span></span>
<span id="cb5-13"><a href="simulation-algorithm.html#cb5-13" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 2       8           2         C          AA 0.1789954     0.1789954 1.0000000</span></span>
<span id="cb5-14"><a href="simulation-algorithm.html#cb5-14" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 3       9           2         E          AB 0.1789954     0.1789954 0.7579891</span></span>
<span id="cb5-15"><a href="simulation-algorithm.html#cb5-15" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb5-16"><a href="simulation-algorithm.html#cb5-16" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; [[3]]</span></span>
<span id="cb5-17"><a href="simulation-algorithm.html#cb5-17" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;   spec_id main_anc_id spec_type branch_code  branch_t spec_origin_t spec_ex_t</span></span>
<span id="cb5-18"><a href="simulation-algorithm.html#cb5-18" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 1       3           3         E           A       NaN     0.0000000 0.1510364</span></span>
<span id="cb5-19"><a href="simulation-algorithm.html#cb5-19" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 2       6           3         E          AA 0.1510364     0.1510364 0.9493026</span></span>
<span id="cb5-20"><a href="simulation-algorithm.html#cb5-20" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 3       7           3         C          AB 0.1510364     0.1510364 1.0000000</span></span>
<span id="cb5-21"><a href="simulation-algorithm.html#cb5-21" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb5-22"><a href="simulation-algorithm.html#cb5-22" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; [[4]]</span></span>
<span id="cb5-23"><a href="simulation-algorithm.html#cb5-23" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;   spec_id main_anc_id spec_type branch_code branch_t spec_origin_t spec_ex_t</span></span>
<span id="cb5-24"><a href="simulation-algorithm.html#cb5-24" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 1       4           4         E           A      NaN             0 0.1510364</span></span>
<span id="cb5-25"><a href="simulation-algorithm.html#cb5-25" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb5-26"><a href="simulation-algorithm.html#cb5-26" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; [[5]]</span></span>
<span id="cb5-27"><a href="simulation-algorithm.html#cb5-27" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;   spec_id main_anc_id spec_type branch_code branch_t spec_origin_t spec_ex_t</span></span>
<span id="cb5-28"><a href="simulation-algorithm.html#cb5-28" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 1       5           5         E           A      NaN             0 0.1789954</span></span></code></pre></div>
<p>Specifically focusing on one of these mainland clades (see Section <a href="daisiemainland-data-standards.html#mainland-clade">A.2.5</a>):</p>
<div class="sourceCode" id="cb6"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb6-1"><a href="simulation-algorithm.html#cb6-1" aria-hidden="true" tabindex="-1"></a>mainland[[<span class="dv">1</span>]]</span>
<span id="cb6-2"><a href="simulation-algorithm.html#cb6-2" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;   spec_id main_anc_id spec_type branch_code  branch_t spec_origin_t spec_ex_t</span></span>
<span id="cb6-3"><a href="simulation-algorithm.html#cb6-3" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 1       1           1         E           A       NaN     0.0000000 0.7579891</span></span>
<span id="cb6-4"><a href="simulation-algorithm.html#cb6-4" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 2      10           1         E          AA 0.7579891     0.7579891 0.9493026</span></span>
<span id="cb6-5"><a href="simulation-algorithm.html#cb6-5" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 3      11           1         C          AB 0.7579891     0.7579891 1.0000000</span></span>
<span id="cb6-6"><a href="simulation-algorithm.html#cb6-6" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 4      12           1         C         AAA 0.9493026     0.9493026 1.0000000</span></span>
<span id="cb6-7"><a href="simulation-algorithm.html#cb6-7" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 5      13           1         C         AAB 0.9493026     0.9493026 1.0000000</span></span></code></pre></div>
<p>We can see that the information on this mainland clade include the ID of each
species (<code>spec_id</code>). The ID of the mainland ancestor from which that species
derived (<code>main_anc_id</code>). The type of species (<code>spec_type</code>) these can be <code>I</code>,
<code>C</code>, or <code>E</code> for single lineage clade, cladogenetic species in a clade, or
extinct species, respectively. All mainland species are initialised as
<code>spec_id = I</code> but as the simulation progresses species become either
part of a clade (<code>C</code>) or extinct (<code>E</code>). By keeping the extinct species we have
a full history of the mainland and not the so-called reconstructed history which
would only contain the living (extant) species. The <code>branch_code</code> provides the
evolutionary relationships of the species in the clade and allows the topology
of the clade to be constructed. The <code>branch_t</code> is the time when the species
speciated from their common ancestor (in time after the start of the simulation
and not time before present). The <code>spec_origin_t</code> is the time the species
originated and is often equal to the <code>branch_t</code>. The <code>spec_ex_t</code> is the time the species went extinct (again in time after the start of the simulation). Species
that do not go extinct are give a <code>spec_ex_t</code> equal to the total time of the
simulation.</p>
<p>Another example of what can happen on the mainland is the extinction of a
singleton lineage before it underwent speciation.</p>
<div class="sourceCode" id="cb7"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb7-1"><a href="simulation-algorithm.html#cb7-1" aria-hidden="true" tabindex="-1"></a>mainland[[<span class="dv">4</span>]]</span>
<span id="cb7-2"><a href="simulation-algorithm.html#cb7-2" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;   spec_id main_anc_id spec_type branch_code branch_t spec_origin_t spec_ex_t</span></span>
<span id="cb7-3"><a href="simulation-algorithm.html#cb7-3" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 1       4           4         E           A      NaN             0 0.1510364</span></span></code></pre></div>
</div>
<div id="island-simulation" class="section level2 hasAnchor" number="2.2">
<h2><span class="header-section-number">2.2</span> Island simulation<a href="simulation-algorithm.html#island-simulation" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>The island simulation runs after the mainland simulation and uses the mainland
data to determine which species can immigrate to the island through time. Doob-Gillespie algorithm is altered to accommodate the dynamic
mainland pool. The time-steps are bounded to not jump over changes on the
mainland to ensure the present state of the system (i.e.Â species on mainland)
is always up-to-date. The algorithm checks whether any changes have occurs on
the mainland since the last time step and if so the system is updated and the
returned to the time at which the mainland last changed. This is valid owing to
the Markov (memoryless) property of the Doob-Gillespie algorithm.</p>
<div class="sourceCode" id="cb8"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb8-1"><a href="simulation-algorithm.html#cb8-1" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(</span>
<span id="cb8-2"><a href="simulation-algorithm.html#cb8-2" aria-hidden="true" tabindex="-1"></a>  <span class="dv">1</span>,</span>
<span id="cb8-3"><a href="simulation-algorithm.html#cb8-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">kind =</span> <span class="st">&quot;Mersenne-Twister&quot;</span>,</span>
<span id="cb8-4"><a href="simulation-algorithm.html#cb8-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">normal.kind =</span> <span class="st">&quot;Inversion&quot;</span>,</span>
<span id="cb8-5"><a href="simulation-algorithm.html#cb8-5" aria-hidden="true" tabindex="-1"></a>  <span class="at">sample.kind =</span> <span class="st">&quot;Rejection&quot;</span></span>
<span id="cb8-6"><a href="simulation-algorithm.html#cb8-6" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb8-7"><a href="simulation-algorithm.html#cb8-7" aria-hidden="true" tabindex="-1"></a>island_tbl <span class="ot">&lt;-</span> DAISIEmainland<span class="sc">:::</span><span class="fu">sim_island</span>(</span>
<span id="cb8-8"><a href="simulation-algorithm.html#cb8-8" aria-hidden="true" tabindex="-1"></a>  <span class="at">total_time =</span> <span class="dv">1</span>,</span>
<span id="cb8-9"><a href="simulation-algorithm.html#cb8-9" aria-hidden="true" tabindex="-1"></a>  <span class="at">island_pars =</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">10</span>, <span class="dv">1</span>, <span class="dv">1</span>),</span>
<span id="cb8-10"><a href="simulation-algorithm.html#cb8-10" aria-hidden="true" tabindex="-1"></a>  <span class="at">mainland_clade =</span> mainland[[<span class="dv">1</span>]],</span>
<span id="cb8-11"><a href="simulation-algorithm.html#cb8-11" aria-hidden="true" tabindex="-1"></a>  <span class="at">mainland_sample_prob =</span> <span class="dv">1</span>,</span>
<span id="cb8-12"><a href="simulation-algorithm.html#cb8-12" aria-hidden="true" tabindex="-1"></a>  <span class="at">mainland_sample_type =</span> <span class="st">&quot;complete&quot;</span></span>
<span id="cb8-13"><a href="simulation-algorithm.html#cb8-13" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb8-14"><a href="simulation-algorithm.html#cb8-14" aria-hidden="true" tabindex="-1"></a>island_tbl</span>
<span id="cb8-15"><a href="simulation-algorithm.html#cb8-15" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;   spec_id main_anc_id     col_t spec_type branch_code branch_t          ana_origin</span></span>
<span id="cb8-16"><a href="simulation-algorithm.html#cb8-16" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 1       1           1 0.7551818         A        &lt;NA&gt;      NaN mainland_extinction</span></span>
<span id="cb8-17"><a href="simulation-algorithm.html#cb8-17" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 2      10          10 0.8507697         A        &lt;NA&gt;      NaN mainland_extinction</span></span></code></pre></div>
<p>The island simulation outputs a <code>island_tbl</code> (see Section <a href="daisiemainland-data-standards.html#island-tbl">A.2.6</a>).
The <code>island_tbl</code> includes again the species ID (<code>spec_id</code>), mainland ancestor
ID (<code>main_anc_id</code>), species type (<code>spec_type</code>), branching code (<code>branch_code</code>), and branching time (<code>branch_t</code>). It also includes the time at which the species
colonised the island (<code>col_t</code>) and the reason a species is anagenetic (i.e.
endemic to the island without being in an island clade). The reasons for a
species to be anagenetic are: the mainland population of the species goes
extinct (<code>mainland_extinction</code>), the species undergoes anagenesis on the island
(<code>immig_parent</code>), or the species formed a clade but all other members of the
clade went extinct before the present (<code>clade_extinct</code>).</p>
<p>One major difference between the island and mainland data that are produced by
<code>sim_mainland()</code> and <code>sim_island()</code> is that the latter only has
information from the reconstructed point of view. This means extinct species
are removed from the data set and only species extant at the end of the
simulation are included.</p>
<p>For both the island and mainland Doob-Gillespie algorithms time steps are
sampled from an exponential distribution with rate:</p>
<p><span class="math display">\[X = \lambda e ^{-\lambda x}, \text{ where } \lambda = \sum_j r_j\]</span></p>
<p>where <span class="math inline">\(r_j\)</span> are the rates, for the mainland process this is just the rate of
mainland extinction (<span class="math inline">\(\mu_M\)</span>), this is the only mainland parameter, whereas,
for the island algorithm <span class="math inline">\(r_j\)</span> are the rates of cladogenesis (<span class="math inline">\(\lambda^c\)</span>),
island extinction (<span class="math inline">\(\mu\)</span>), colonisation (<span class="math inline">\(\gamma\)</span>), and anagenesis
(<span class="math inline">\(\lambda^a\)</span>). After the time step (<span class="math inline">\(\Delta\)</span> t) is sampled the event is sampled
from a dynamic discrete probability distribution, weighted by its rate
(propensity) relative to all other rates:</p>
<p><span class="math display">\[r_i / \sum_j r_j\]</span></p>
<p>The system is then updated for the algorithm repeats until the time step exceeds
the total time of the simulation.</p>
<p>The function that encapsulates and runs both of these simulations is <code>sim_island_with_mainland()</code>. This function also includes the formatting of the data and the assignment of an endemicity status to each island colonist, which
needed by the <code>DAISIE</code> inference model. The <code>DAISIEmainland</code> simulation outputs two data sets: (1) contains full information of all species colonisation times, and (2) an incomplete information data set which resembles what an empirist would have access to (see Section <a href="daisiemainland-data-standards.html#daisie-mainland-data">A.2.1</a>). These two data sets allow for the quantification of error in
estimation when the empirists does not have access to all the data.</p>
<div class="sourceCode" id="cb9"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb9-1"><a href="simulation-algorithm.html#cb9-1" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(</span>
<span id="cb9-2"><a href="simulation-algorithm.html#cb9-2" aria-hidden="true" tabindex="-1"></a>  <span class="dv">1</span>,</span>
<span id="cb9-3"><a href="simulation-algorithm.html#cb9-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">kind =</span> <span class="st">&quot;Mersenne-Twister&quot;</span>,</span>
<span id="cb9-4"><a href="simulation-algorithm.html#cb9-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">normal.kind =</span> <span class="st">&quot;Inversion&quot;</span>,</span>
<span id="cb9-5"><a href="simulation-algorithm.html#cb9-5" aria-hidden="true" tabindex="-1"></a>  <span class="at">sample.kind =</span> <span class="st">&quot;Rejection&quot;</span></span>
<span id="cb9-6"><a href="simulation-algorithm.html#cb9-6" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb9-7"><a href="simulation-algorithm.html#cb9-7" aria-hidden="true" tabindex="-1"></a>daisie_mainland_data <span class="ot">&lt;-</span> <span class="fu">sim_island_with_mainland</span>(</span>
<span id="cb9-8"><a href="simulation-algorithm.html#cb9-8" aria-hidden="true" tabindex="-1"></a>  <span class="at">total_time =</span> <span class="dv">1</span>,</span>
<span id="cb9-9"><a href="simulation-algorithm.html#cb9-9" aria-hidden="true" tabindex="-1"></a>  <span class="at">m =</span> <span class="dv">5</span>,</span>
<span id="cb9-10"><a href="simulation-algorithm.html#cb9-10" aria-hidden="true" tabindex="-1"></a>  <span class="at">island_pars =</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">10</span>, <span class="dv">1</span>, <span class="dv">1</span>), </span>
<span id="cb9-11"><a href="simulation-algorithm.html#cb9-11" aria-hidden="true" tabindex="-1"></a>  <span class="at">mainland_ex =</span> <span class="dv">1</span>,</span>
<span id="cb9-12"><a href="simulation-algorithm.html#cb9-12" aria-hidden="true" tabindex="-1"></a>  <span class="at">mainland_sample_prob =</span> <span class="dv">1</span>,</span>
<span id="cb9-13"><a href="simulation-algorithm.html#cb9-13" aria-hidden="true" tabindex="-1"></a>  <span class="at">mainland_sample_type =</span> <span class="st">&quot;unsampled&quot;</span>,</span>
<span id="cb9-14"><a href="simulation-algorithm.html#cb9-14" aria-hidden="true" tabindex="-1"></a>  <span class="at">replicates =</span> <span class="dv">1</span> </span>
<span id="cb9-15"><a href="simulation-algorithm.html#cb9-15" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb9-16"><a href="simulation-algorithm.html#cb9-16" aria-hidden="true" tabindex="-1"></a>daisie_mainland_data</span>
<span id="cb9-17"><a href="simulation-algorithm.html#cb9-17" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; $ideal_multi_daisie_data</span></span>
<span id="cb9-18"><a href="simulation-algorithm.html#cb9-18" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; $ideal_multi_daisie_data[[1]]</span></span>
<span id="cb9-19"><a href="simulation-algorithm.html#cb9-19" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; $ideal_multi_daisie_data[[1]][[1]]</span></span>
<span id="cb9-20"><a href="simulation-algorithm.html#cb9-20" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; $ideal_multi_daisie_data[[1]][[1]]$island_age</span></span>
<span id="cb9-21"><a href="simulation-algorithm.html#cb9-21" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; [1] 1</span></span>
<span id="cb9-22"><a href="simulation-algorithm.html#cb9-22" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb9-23"><a href="simulation-algorithm.html#cb9-23" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; $ideal_multi_daisie_data[[1]][[1]]$not_present</span></span>
<span id="cb9-24"><a href="simulation-algorithm.html#cb9-24" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; [1] 3</span></span>
<span id="cb9-25"><a href="simulation-algorithm.html#cb9-25" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb9-26"><a href="simulation-algorithm.html#cb9-26" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb9-27"><a href="simulation-algorithm.html#cb9-27" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; $ideal_multi_daisie_data[[1]][[2]]</span></span>
<span id="cb9-28"><a href="simulation-algorithm.html#cb9-28" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; $ideal_multi_daisie_data[[1]][[2]]$branching_times</span></span>
<span id="cb9-29"><a href="simulation-algorithm.html#cb9-29" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; [1] 1.0000000 0.1026008</span></span>
<span id="cb9-30"><a href="simulation-algorithm.html#cb9-30" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb9-31"><a href="simulation-algorithm.html#cb9-31" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; $ideal_multi_daisie_data[[1]][[2]]$stac</span></span>
<span id="cb9-32"><a href="simulation-algorithm.html#cb9-32" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; [1] 2</span></span>
<span id="cb9-33"><a href="simulation-algorithm.html#cb9-33" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb9-34"><a href="simulation-algorithm.html#cb9-34" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; $ideal_multi_daisie_data[[1]][[2]]$missing_species</span></span>
<span id="cb9-35"><a href="simulation-algorithm.html#cb9-35" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; [1] 0</span></span>
<span id="cb9-36"><a href="simulation-algorithm.html#cb9-36" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb9-37"><a href="simulation-algorithm.html#cb9-37" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb9-38"><a href="simulation-algorithm.html#cb9-38" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; $ideal_multi_daisie_data[[1]][[3]]</span></span>
<span id="cb9-39"><a href="simulation-algorithm.html#cb9-39" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; $ideal_multi_daisie_data[[1]][[3]]$branching_times</span></span>
<span id="cb9-40"><a href="simulation-algorithm.html#cb9-40" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; [1] 1.0000000 0.9627315</span></span>
<span id="cb9-41"><a href="simulation-algorithm.html#cb9-41" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb9-42"><a href="simulation-algorithm.html#cb9-42" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; $ideal_multi_daisie_data[[1]][[3]]$stac</span></span>
<span id="cb9-43"><a href="simulation-algorithm.html#cb9-43" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; [1] 2</span></span>
<span id="cb9-44"><a href="simulation-algorithm.html#cb9-44" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb9-45"><a href="simulation-algorithm.html#cb9-45" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; $ideal_multi_daisie_data[[1]][[3]]$missing_species</span></span>
<span id="cb9-46"><a href="simulation-algorithm.html#cb9-46" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; [1] 0</span></span>
<span id="cb9-47"><a href="simulation-algorithm.html#cb9-47" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb9-48"><a href="simulation-algorithm.html#cb9-48" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb9-49"><a href="simulation-algorithm.html#cb9-49" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb9-50"><a href="simulation-algorithm.html#cb9-50" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb9-51"><a href="simulation-algorithm.html#cb9-51" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; $empirical_multi_daisie_data</span></span>
<span id="cb9-52"><a href="simulation-algorithm.html#cb9-52" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; $empirical_multi_daisie_data[[1]]</span></span>
<span id="cb9-53"><a href="simulation-algorithm.html#cb9-53" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; $empirical_multi_daisie_data[[1]][[1]]</span></span>
<span id="cb9-54"><a href="simulation-algorithm.html#cb9-54" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; $empirical_multi_daisie_data[[1]][[1]]$island_age</span></span>
<span id="cb9-55"><a href="simulation-algorithm.html#cb9-55" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; [1] 1</span></span>
<span id="cb9-56"><a href="simulation-algorithm.html#cb9-56" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb9-57"><a href="simulation-algorithm.html#cb9-57" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; $empirical_multi_daisie_data[[1]][[1]]$not_present</span></span>
<span id="cb9-58"><a href="simulation-algorithm.html#cb9-58" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; [1] 3</span></span>
<span id="cb9-59"><a href="simulation-algorithm.html#cb9-59" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb9-60"><a href="simulation-algorithm.html#cb9-60" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb9-61"><a href="simulation-algorithm.html#cb9-61" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; $empirical_multi_daisie_data[[1]][[2]]</span></span>
<span id="cb9-62"><a href="simulation-algorithm.html#cb9-62" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; $empirical_multi_daisie_data[[1]][[2]]$branching_times</span></span>
<span id="cb9-63"><a href="simulation-algorithm.html#cb9-63" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; [1] 1.0000000 0.8489636</span></span>
<span id="cb9-64"><a href="simulation-algorithm.html#cb9-64" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb9-65"><a href="simulation-algorithm.html#cb9-65" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; $empirical_multi_daisie_data[[1]][[2]]$stac</span></span>
<span id="cb9-66"><a href="simulation-algorithm.html#cb9-66" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; [1] 2</span></span>
<span id="cb9-67"><a href="simulation-algorithm.html#cb9-67" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb9-68"><a href="simulation-algorithm.html#cb9-68" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; $empirical_multi_daisie_data[[1]][[2]]$missing_species</span></span>
<span id="cb9-69"><a href="simulation-algorithm.html#cb9-69" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; [1] 0</span></span>
<span id="cb9-70"><a href="simulation-algorithm.html#cb9-70" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb9-71"><a href="simulation-algorithm.html#cb9-71" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb9-72"><a href="simulation-algorithm.html#cb9-72" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; $empirical_multi_daisie_data[[1]][[3]]</span></span>
<span id="cb9-73"><a href="simulation-algorithm.html#cb9-73" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; $empirical_multi_daisie_data[[1]][[3]]$branching_times</span></span>
<span id="cb9-74"><a href="simulation-algorithm.html#cb9-74" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; [1] 1.00000 0.99999</span></span>
<span id="cb9-75"><a href="simulation-algorithm.html#cb9-75" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb9-76"><a href="simulation-algorithm.html#cb9-76" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; $empirical_multi_daisie_data[[1]][[3]]$stac</span></span>
<span id="cb9-77"><a href="simulation-algorithm.html#cb9-77" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; [1] 5</span></span>
<span id="cb9-78"><a href="simulation-algorithm.html#cb9-78" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb9-79"><a href="simulation-algorithm.html#cb9-79" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; $empirical_multi_daisie_data[[1]][[3]]$missing_species</span></span>
<span id="cb9-80"><a href="simulation-algorithm.html#cb9-80" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; [1] 0</span></span></code></pre></div>

</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="installation.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="simulation-data-visualisation.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"whatsapp": false,
"all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": null,
"text": null
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": null,
"search": {
"engine": "fuse",
"options": null
},
"toc": {
"collapse": "subsection"
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
