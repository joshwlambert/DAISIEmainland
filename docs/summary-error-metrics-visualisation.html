<!DOCTYPE html>
<html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>5 Summary and error metrics visualisation | DAISIEmainland: Simulating and analysing macroevolution on islands with a dynamic mainland</title>
<meta name="author" content="Joshua W. Lambert">
<meta name="description" content="There is a range of plotting functions to visualise the summary metrics and error metrics (Section 4.3). For the plotting of simulation summary and error metrics we need to load the results from...">
<meta name="generator" content="bookdown 0.26 with bs4_book()">
<meta property="og:title" content="5 Summary and error metrics visualisation | DAISIEmainland: Simulating and analysing macroevolution on islands with a dynamic mainland">
<meta property="og:type" content="book">
<meta property="og:description" content="There is a range of plotting functions to visualise the summary metrics and error metrics (Section 4.3). For the plotting of simulation summary and error metrics we need to load the results from...">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="5 Summary and error metrics visualisation | DAISIEmainland: Simulating and analysing macroevolution on islands with a dynamic mainland">
<meta name="twitter:description" content="There is a range of plotting functions to visualise the summary metrics and error metrics (Section 4.3). For the plotting of simulation summary and error metrics we need to load the results from...">
<!-- JS --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://kit.fontawesome.com/6ecbd6c532.js" crossorigin="anonymous"></script><script src="libs/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="libs/bootstrap-4.6.0/bootstrap.min.css" rel="stylesheet">
<script src="libs/bootstrap-4.6.0/bootstrap.bundle.min.js"></script><script src="libs/bs3compat-0.3.1/transition.js"></script><script src="libs/bs3compat-0.3.1/tabs.js"></script><script src="libs/bs3compat-0.3.1/bs3compat.js"></script><link href="libs/bs4_book-1.0.0/bs4_book.css" rel="stylesheet">
<script src="libs/bs4_book-1.0.0/bs4_book.js"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- CSS --><style type="text/css">
    
    div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
  </style>
<style type="text/css">
    /* Used with Pandoc 2.11+ new --citeproc when CSL is used */
    div.csl-bib-body { }
    div.csl-entry {
      clear: both;
        }
    .hanging div.csl-entry {
      margin-left:2em;
      text-indent:-2em;
    }
    div.csl-left-margin {
      min-width:2em;
      float:left;
    }
    div.csl-right-inline {
      margin-left:2em;
      padding-left:1em;
    }
    div.csl-indent {
      margin-left: 2em;
    }
  </style>
</head>
<body data-spy="scroll" data-target="#toc">

<div class="container-fluid">
<div class="row">
  <header class="col-sm-12 col-lg-3 sidebar sidebar-book"><a class="sr-only sr-only-focusable" href="#content">Skip to main content</a>

    <div class="d-flex align-items-start justify-content-between">
      <h1>
        <a href="index.html" title="">DAISIEmainland: Simulating and analysing macroevolution on islands with a dynamic mainland</a>
      </h1>
      <button class="btn btn-outline-primary d-lg-none ml-2 mt-1" type="button" data-toggle="collapse" data-target="#main-nav" aria-expanded="true" aria-controls="main-nav"><i class="fas fa-bars"></i><span class="sr-only">Show table of contents</span></button>
    </div>

    <div id="main-nav" class="collapse-lg">
      <form role="search">
        <input id="search" class="form-control" type="search" placeholder="Search" aria-label="Search">
</form>

      <nav aria-label="Table of contents"><h2>Table of contents</h2>
        <ul class="book-toc list-unstyled">
<li><a class="" href="index.html">DAISIEmainland guide</a></li>
<li><a class="" href="installation.html"><span class="header-section-number">1</span> Installation</a></li>
<li><a class="" href="simulation-algorithm.html"><span class="header-section-number">2</span> Simulation algorithm</a></li>
<li><a class="" href="simulation-data-visualisation.html"><span class="header-section-number">3</span> Simulation data visualisation</a></li>
<li><a class="" href="inference-performance.html"><span class="header-section-number">4</span> Inference performance</a></li>
<li><a class="active" href="summary-error-metrics-visualisation.html"><span class="header-section-number">5</span> Summary and error metrics visualisation</a></li>
<li><a class="" href="references.html"><span class="header-section-number">6</span> References</a></li>
<li class="book-part">Appendix</li>
<li><a class="" href="data-standards.html"><span class="header-section-number">A</span> Data standards</a></li>
</ul>

        <div class="book-extra">
          
        </div>
      </nav>
</div>
  </header><main class="col-sm-12 col-md-9 col-lg-7" id="content"><div id="summary-error-metrics-visualisation" class="section level1" number="5">
<h1>
<span class="header-section-number">5</span> Summary and error metrics visualisation<a class="anchor" aria-label="anchor" href="#summary-error-metrics-visualisation"><i class="fas fa-link"></i></a>
</h1>
<p>There is a range of plotting functions to visualise the summary metrics and
error metrics (Section <a href="inference-performance.html#inference-performance-error-metrics">4.3</a>).</p>
<p>For the plotting of simulation summary and error metrics we need to load the
results from multiple different mainland extinction scenarios.</p>
<div class="sourceCode" id="cb25"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">analysis_results</span> <span class="op">&lt;-</span> <span class="fu">DAISIEmainland</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/DAISIEmainland/man/read_analysis_results.html">read_analysis_results</a></span><span class="op">(</span>
  data_folder_path <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/system.file.html">system.file</a></span><span class="op">(</span>
    <span class="st">"/inst/book/data/param_sets/"</span>, 
    package <span class="op">=</span> <span class="st">"DAISIEmainland"</span>
  <span class="op">)</span>
<span class="op">)</span></code></pre></div>
<div id="simulation-summary-metrics" class="section level2" number="5.1">
<h2>
<span class="header-section-number">5.1</span> Simulation summary metrics<a class="anchor" aria-label="anchor" href="#simulation-summary-metrics"><i class="fas fa-link"></i></a>
</h2>
<p>First we run the simulation. This is the same simulation as in the inference
performance section (Section <a href="inference-performance.html#simulating-data">4.1</a>).</p>
<div class="sourceCode" id="cb26"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/base/Random.html">set.seed</a></span><span class="op">(</span>
  <span class="fl">1</span>,
  kind <span class="op">=</span> <span class="st">"Mersenne-Twister"</span>,
  normal.kind <span class="op">=</span> <span class="st">"Inversion"</span>,
  sample.kind <span class="op">=</span> <span class="st">"Rejection"</span>
<span class="op">)</span>

<span class="va">replicates</span> <span class="op">&lt;-</span> <span class="fl">100</span>

<span class="va">daisie_mainland_data</span> <span class="op">&lt;-</span> <span class="fu">DAISIEmainland</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/DAISIEmainland/man/sim_island_with_mainland.html">sim_island_with_mainland</a></span><span class="op">(</span>
  total_time <span class="op">=</span> <span class="fl">1</span>,
  m <span class="op">=</span> <span class="fl">100</span>,
  island_pars <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">0.5</span>, <span class="fl">02.5</span>, <span class="fl">50</span>, <span class="fl">0.01</span>, <span class="fl">0.5</span><span class="op">)</span>,
  mainland_ex <span class="op">=</span> <span class="fl">1.0</span>,
  mainland_sample_prob <span class="op">=</span> <span class="fl">1</span>,
  mainland_sample_type <span class="op">=</span> <span class="st">"complete"</span>,
  replicates <span class="op">=</span> <span class="va">replicates</span>,
  verbose <span class="op">=</span> <span class="cn">FALSE</span>
<span class="op">)</span></code></pre></div>
<p>The simulation summary metrics we can calculate for the <em>ideal</em> and <em>empirical</em> data are:</p>
<ol style="list-style-type: decimal">
<li>number of species on the island at the end of the simulation.</li>
<li>number of colonisation events to the island (that survived to the present) at the end of the simulation.</li>
</ol>
<div class="sourceCode" id="cb27"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">ideal_sim_num_spec</span> <span class="op">&lt;-</span> <span class="fu">DAISIEmainland</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/DAISIEmainland/man/calc_num_spec.html">calc_num_spec</a></span><span class="op">(</span>
  multi_daisie_data <span class="op">=</span> <span class="va">daisie_mainland_data</span><span class="op">$</span><span class="va">ideal_multi_daisie_data</span>
<span class="op">)</span>

<span class="va">ideal_sim_num_spec</span>
<span class="co">#&gt;   [1] 120  94  89  76  63  91  93  81  58 135  95  78 118  93  97 115 109 128 142  73  71  55 109 102 123 134  93 103</span>
<span class="co">#&gt;  [29]  82  73 125  91  83  85 100 107  88  94  95 138 116  89  86 119  60  83 103  87 106 114  72 133 113  80 131  92</span>
<span class="co">#&gt;  [57]  95  81  91  79  66 120 107  69  91  80  71 138 101  99  78  52 173 125  83  76  78  59  94  98 104  68  81  80</span>
<span class="co">#&gt;  [85]  74  94 113  96  76 113  78  85  67 123  70  73  63 127 105  85</span></code></pre></div>
<div class="sourceCode" id="cb28"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">ideal_sim_num_col</span> <span class="op">&lt;-</span> <span class="fu">DAISIEmainland</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/DAISIEmainland/man/calc_num_col.html">calc_num_col</a></span><span class="op">(</span>
  multi_daisie_data <span class="op">=</span> <span class="va">daisie_mainland_data</span><span class="op">$</span><span class="va">ideal_multi_daisie_data</span>
<span class="op">)</span>

<span class="va">ideal_sim_num_col</span>
<span class="co">#&gt;   [1] 44 33 39 28 29 30 33 35 28 42 36 32 46 38 30 38 45 40 40 28 28 28 41 34 39 45 34 32 33 29 31 36 33 32 38 34 36 31</span>
<span class="co">#&gt;  [39] 29 41 43 34 36 34 24 30 33 28 42 37 24 37 43 33 45 35 27 37 37 28 29 40 36 30 31 32 27 48 40 47 30 22 41 38 37 27</span>
<span class="co">#&gt;  [77] 35 28 37 33 40 27 38 30 35 38 39 37 30 37 31 33 25 42 35 37 29 31 31 36</span></code></pre></div>
<div class="sourceCode" id="cb29"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">empirical_sim_num_spec</span> <span class="op">&lt;-</span> <span class="fu">DAISIEmainland</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/DAISIEmainland/man/calc_num_spec.html">calc_num_spec</a></span><span class="op">(</span>
  multi_daisie_data <span class="op">=</span> <span class="va">daisie_mainland_data</span><span class="op">$</span><span class="va">empirical_multi_daisie_data</span>
<span class="op">)</span>

<span class="va">empirical_sim_num_spec</span>
<span class="co">#&gt;   [1] 120  94  89  76  63  91  93  81  58 135  95  78 118  93  97 115 109 128 142  73  71  55 109 102 123 134  93 103</span>
<span class="co">#&gt;  [29]  82  73 125  91  83  85 100 107  88  94  95 138 116  89  86 119  60  83 103  87 106 114  72 133 113  80 131  92</span>
<span class="co">#&gt;  [57]  95  81  91  79  66 120 107  69  91  80  71 138 101  99  78  52 173 125  83  76  78  59  94  98 104  68  81  80</span>
<span class="co">#&gt;  [85]  74  94 113  96  76 113  78  85  67 123  70  73  63 127 105  85</span></code></pre></div>
<div class="sourceCode" id="cb30"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">empirical_sim_num_col</span> <span class="op">&lt;-</span> <span class="fu">DAISIEmainland</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/DAISIEmainland/man/calc_num_col.html">calc_num_col</a></span><span class="op">(</span>
  multi_daisie_data <span class="op">=</span> <span class="va">daisie_mainland_data</span><span class="op">$</span><span class="va">empirical_multi_daisie_data</span>
<span class="op">)</span>

<span class="va">empirical_sim_num_col</span>
<span class="co">#&gt;   [1] 43 33 38 28 28 28 32 33 28 42 36 32 46 37 30 37 43 39 38 28 27 28 39 34 39 45 34 32 33 29 31 36 32 30 36 33 34 31</span>
<span class="co">#&gt;  [39] 29 40 41 32 36 33 24 29 32 28 40 34 23 36 42 33 44 35 27 35 36 28 28 40 35 30 30 32 27 44 40 44 29 22 40 38 37 25</span>
<span class="co">#&gt;  [77] 34 27 35 33 39 26 38 30 35 37 39 37 29 37 30 33 25 42 35 36 29 31 30 35</span></code></pre></div>
<p>We can plot the simulation summary metrics to view the mean, variance, maximum and
minimum number of colonisations and number of species for the <em>ideal</em> and <em>empirical</em>
data.</p>
<div class="sourceCode" id="cb31"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/pkg/DAISIEmainland/man/plot_sim_metrics.html">plot_sim_metrics</a></span><span class="op">(</span>
  analysis_results <span class="op">=</span> <span class="va">analysis_results</span>, 
  output_file_path <span class="op">=</span> <span class="cn">NULL</span>
<span class="op">)</span></code></pre></div>
<div class="inline-figure"><img src="DAISIEmainland_guide_files/figure-html/plot-simulation-summary-metrics-1.png" width="672" style="display: block; margin: auto;"></div>
</div>
<div id="inference-error-metrics" class="section level2" number="5.2">
<h2>
<span class="header-section-number">5.2</span> Inference error metrics<a class="anchor" aria-label="anchor" href="#inference-error-metrics"><i class="fas fa-link"></i></a>
</h2>
<p>The error metrics were run for a range of mainland extinction rates. Then, the
error metrics can be plotted across different rates to determine how the error
varies with faster or slower mainland evolutionary dynamics.</p>
<p>Thus, plotting the <span class="math inline">\(\Delta\)</span>CTT across mainland extinction rates between zero and two
(per species per million years) is informative. As explained in Section
<a href="inference-performance.html#inference-performance-error-metrics">4.3</a> this metric is a comparison between
the <em>ideal</em> and <em>empirical</em> data sets produced by the <code>DAISIEmainland</code> simulation.</p>
<div class="sourceCode" id="cb32"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/pkg/DAISIEmainland/man/plot_ctt_boxplot.html">plot_ctt_boxplot</a></span><span class="op">(</span>
  analysis_results <span class="op">=</span> <span class="va">analysis_results</span>, 
  output_file_path <span class="op">=</span> <span class="cn">NULL</span>,
  parameter <span class="op">=</span> <span class="st">"mainland_ex"</span>
<span class="op">)</span></code></pre></div>
<div class="inline-figure"><img src="DAISIEmainland_guide_files/figure-html/plot-delta-ctt-1.png" width="672" style="display: block; margin: auto;"></div>
<p>The percentage of endemics on the island at the end of the simulation and
percentage of maximum age colonisation times can be plotted for different values
of mainland extinction. Each of the boxplots below shows 100 island replicates.
The left hand panel is for the data set with complete information (<em>ideal</em>) and
the right hand panel is for the data set with incomplete information (<em>empirical</em>).</p>
<div class="sourceCode" id="cb33"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/pkg/DAISIEmainland/man/plot_endemics.html">plot_endemics</a></span><span class="op">(</span>
  analysis_results <span class="op">=</span> <span class="va">analysis_results</span>, 
  output_file_path <span class="op">=</span> <span class="cn">NULL</span>, 
  parameter <span class="op">=</span> <span class="st">"mainland_ex"</span>
<span class="op">)</span> </code></pre></div>
<div class="inline-figure"><img src="DAISIEmainland_guide_files/figure-html/plot-endemics-1.png" width="672" style="display: block; margin: auto;"></div>
<div class="sourceCode" id="cb34"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/pkg/DAISIEmainland/man/plot_max_age.html">plot_max_age</a></span><span class="op">(</span>
  analysis_results <span class="op">=</span> <span class="va">analysis_results</span>, 
  output_file_path <span class="op">=</span> <span class="cn">NULL</span>, 
  parameter <span class="op">=</span> <span class="st">"mainland_ex"</span>
<span class="op">)</span></code></pre></div>
<div class="inline-figure"><img src="DAISIEmainland_guide_files/figure-html/plot-max-age-1.png" width="672" style="display: block; margin: auto;"></div>
<p>The plots shown in this chapter are not an exhaustive list available from the
package. For example, error metrics can also be plotted across different values of mainland sampling
probability by setting the <code>parameter = "mainland_sample_prob"</code> in the plotting
functions. The script used to make the plots for the two manuscripts using this
package can be found <a href="https://github.com/joshwlambert/DAISIEmainland/blob/main/scripts/joss_data_vis.R">here</a>
and <a href="https://raw.githubusercontent.com/joshwlambert/DAISIEmainland/main/scripts/evolution_data_vis.R">here</a>.</p>

</div>
</div>
  <div class="chapter-nav">
<div class="prev"><a href="inference-performance.html"><span class="header-section-number">4</span> Inference performance</a></div>
<div class="next"><a href="references.html"><span class="header-section-number">6</span> References</a></div>
</div></main><div class="col-md-3 col-lg-2 d-none d-md-block sidebar sidebar-chapter">
    <nav id="toc" data-toggle="toc" aria-label="On this page"><h2>On this page</h2>
      <ul class="nav navbar-nav">
<li><a class="nav-link" href="#summary-error-metrics-visualisation"><span class="header-section-number">5</span> Summary and error metrics visualisation</a></li>
<li><a class="nav-link" href="#simulation-summary-metrics"><span class="header-section-number">5.1</span> Simulation summary metrics</a></li>
<li><a class="nav-link" href="#inference-error-metrics"><span class="header-section-number">5.2</span> Inference error metrics</a></li>
</ul>

      <div class="book-extra">
        <ul class="list-unstyled">
          
        </ul>
</div>
    </nav>
</div>

</div>
</div> <!-- .container -->

<footer class="bg-primary text-light mt-5"><div class="container"><div class="row">

  <div class="col-12 col-md-6 mt-3">
    <p>"<strong>DAISIEmainland: Simulating and analysing macroevolution on islands with a dynamic mainland</strong>" was written by Joshua W. Lambert. It was last built on 2022-04-28.</p>
  </div>

  <div class="col-12 col-md-6 mt-3">
    <p>This book was built by the <a class="text-light" href="https://bookdown.org">bookdown</a> R package.</p>
  </div>

</div></div>
</footer><!-- dynamically load mathjax for compatibility with self-contained --><script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script><script type="text/x-mathjax-config">const popovers = document.querySelectorAll('a.footnote-ref[data-toggle="popover"]');
for (let popover of popovers) {
  const div = document.createElement('div');
  div.setAttribute('style', 'position: absolute; top: 0, left:0; width:0, height:0, overflow: hidden; visibility: hidden;');
  div.innerHTML = popover.getAttribute('data-content');

  var has_math = div.querySelector("span.math");
  if (has_math) {
    document.body.appendChild(div);
    MathJax.Hub.Queue(["Typeset", MathJax.Hub, div]);
    MathJax.Hub.Queue(function() {
      popover.setAttribute('data-content', div.innerHTML);
      document.body.removeChild(div);
    })
  }
}
</script>
</body>
</html>
